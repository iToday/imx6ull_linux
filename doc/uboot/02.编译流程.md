# 编译流程
编译过程分两步：  
		1.make mx6ull_14x14_evk_defconfig   **//生成.config**  
		2.make  **//根据.config编译**  
下面详细分析执行过程；
## make mx6ull_14x14_evk_defconfig流程
执行***make mx6ull_14x14_evk_defconfig V=1***查看执行过程如下  
		make -f ./scripts/Makefile.build obj=scripts/basic  **//编译fixdep**  
		...       
		make -f ./scripts/Makefile.build obj=scripts/kconfig mx6ull_14x14_evk_defconfig **//编译conf**   
  		...   
  		scripts/kconfig/conf  --defconfig=arch/../configs/mx6ull_14x14_evk_defconfig Kconfig  **//生成.config文件**  
		#  
		# configuration written to .config  
		#  

### .config 生成过程
		conf通过conf_parse(Kconfig)来解析可选的配置信息，保存到一个链表中；
		随后通过conf_read(mx6ull_14x14_evk_defconfig)读取默认的设置文件,并且生成新的配置文件；
		调用conf_set_all_new_symbols更新关系链表最后调用conf_write写入到.config中

## make流程
执行***make V=1***查看执行过程如下：  
完整日志见[make.log](./logs/make.log)，下面是过滤出来的make命令：  

		make -f ./Makefile syncconfig
		make -f ./scripts/Makefile.build obj=scripts/basic
		make -f ./scripts/Makefile.build obj=scripts/kconfig syncconfig
		make -f ./scripts/Makefile.autoconf || \
		make -f ./scripts/Makefile.build obj=scripts/basic
		make -f ./scripts/Makefile.build obj=.
		make -f ./scripts/Makefile.build obj=scripts/dtc
		make -f ./scripts/Makefile.build obj=scripts
		make -f ./scripts/Makefile.build obj=scripts/dtc
		make -f ./scripts/Makefile.build obj=tools
		make -f ./scripts/Makefile.build obj=arch/arm/cpu
		make -f ./scripts/Makefile.build obj=arch/arm/cpu/armv7
		make -f ./scripts/Makefile.build obj=arch/arm/lib
		make -f ./scripts/Makefile.build obj=arch/arm/mach-imx
		make -f ./scripts/Makefile.build obj=arch/arm/mach-imx/mx6
		make -f ./scripts/Makefile.build obj=board/freescale/common
		make -f ./scripts/Makefile.build obj=board/freescale/mx6ullevk
		make -f ./scripts/Makefile.build obj=cmd
		make -f ./scripts/Makefile.build obj=cmd/arm
		make -f ./scripts/Makefile.build obj=common
		make -f ./scripts/Makefile.build obj=common/init
		make -f ./scripts/Makefile.build obj=disk
		make -f ./scripts/Makefile.build obj=drivers
		make -f ./scripts/Makefile.build obj=drivers/adc
		make -f ./scripts/Makefile.build obj=drivers/ata
		make -f ./scripts/Makefile.build obj=drivers/axi
		make -f ./scripts/Makefile.build obj=drivers/block
		make -f ./scripts/Makefile.build obj=drivers/bus
		make -f ./scripts/Makefile.build obj=drivers/cache
		make -f ./scripts/Makefile.build obj=drivers/core
		make -f ./scripts/Makefile.build obj=drivers/crypto
		make -f ./scripts/Makefile.build obj=drivers/crypto/fsl
		make -f ./scripts/Makefile.build obj=drivers/crypto/rsa_mod_exp
		make -f ./scripts/Makefile.build obj=drivers/dfu
		make -f ./scripts/Makefile.build obj=drivers/i2c
		make -f ./scripts/Makefile.build obj=drivers/input
		make -f ./scripts/Makefile.build obj=drivers/mailbox
		make -f ./scripts/Makefile.build obj=drivers/memory
		make -f ./scripts/Makefile.build obj=drivers/misc
		make -f ./scripts/Makefile.build obj=drivers/mmc
		make -f ./scripts/Makefile.build obj=drivers/mtd
		make -f ./scripts/Makefile.build obj=drivers/mtd/nand
		make -f ./scripts/Makefile.build obj=drivers/mtd/onenand
		make -f ./scripts/Makefile.build obj=drivers/mtd/spi
		make -f ./scripts/Makefile.build obj=drivers/pinctrl
		make -f ./scripts/Makefile.build obj=drivers/pinctrl/broadcom
		make -f ./scripts/Makefile.build obj=drivers/pinctrl/nxp
		make -f ./scripts/Makefile.build obj=drivers/pwm
		make -f ./scripts/Makefile.build obj=drivers/reset
		make -f ./scripts/Makefile.build obj=drivers/rtc
		make -f ./scripts/Makefile.build obj=drivers/scsi
		make -f ./scripts/Makefile.build obj=drivers/smem
		make -f ./scripts/Makefile.build obj=drivers/soc
		make -f ./scripts/Makefile.build obj=drivers/sound
		make -f ./scripts/Makefile.build obj=drivers/spmi
		make -f ./scripts/Makefile.build obj=drivers/thermal
		make -f ./scripts/Makefile.build obj=drivers/ufs
		make -f ./scripts/Makefile.build obj=drivers/video
		make -f ./scripts/Makefile.build obj=drivers/video/bridge
		make -f ./scripts/Makefile.build obj=drivers/video/sunxi
		make -f ./scripts/Makefile.build obj=drivers/video/ti
		make -f ./scripts/Makefile.build obj=drivers/watchdog
		make -f ./scripts/Makefile.build obj=drivers/dma
		make -f ./scripts/Makefile.build obj=drivers/dma/ti
		make -f ./scripts/Makefile.build obj=drivers/gpio
		make -f ./scripts/Makefile.build obj=drivers/net
		make -f ./scripts/Makefile.build obj=drivers/net/mscc_eswitch
		make -f ./scripts/Makefile.build obj=drivers/net/qe
		make -f ./scripts/Makefile.build obj=drivers/net/ti
		make -f ./scripts/Makefile.build obj=drivers/net/phy
		make -f ./scripts/Makefile.build obj=drivers/power
		make -f ./scripts/Makefile.build obj=drivers/power/battery
		make -f ./scripts/Makefile.build obj=drivers/power/domain
		make -f ./scripts/Makefile.build obj=drivers/power/fuel_gauge
		make -f ./scripts/Makefile.build obj=drivers/power/mfd
		make -f ./scripts/Makefile.build obj=drivers/power/pmic
		make -f ./scripts/Makefile.build obj=drivers/power/regulator
		make -f ./scripts/Makefile.build obj=drivers/serial
		make -f ./scripts/Makefile.build obj=drivers/spi
		make -f ./scripts/Makefile.build obj=drivers/usb/cdns3
		make -f ./scripts/Makefile.build obj=drivers/usb/common
		make -f ./scripts/Makefile.build obj=drivers/usb/dwc3
		make -f ./scripts/Makefile.build obj=drivers/usb/emul
		make -f ./scripts/Makefile.build obj=drivers/usb/eth
		make -f ./scripts/Makefile.build obj=drivers/usb/host
		make -f ./scripts/Makefile.build obj=drivers/usb/mtu3
		make -f ./scripts/Makefile.build obj=drivers/usb/musb-new
		make -f ./scripts/Makefile.build obj=drivers/usb/musb
		make -f ./scripts/Makefile.build obj=drivers/usb/phy
		make -f ./scripts/Makefile.build obj=drivers/usb/ulpi
		make -f ./scripts/Makefile.build obj=env
		make -f ./scripts/Makefile.build obj=fs
		make -f ./scripts/Makefile.build obj=fs/ext4
		make -f ./scripts/Makefile.build obj=fs/fat
		make -f ./scripts/Makefile.build obj=lib
		make -f ./scripts/Makefile.build obj=lib/crypto
		make -f ./scripts/Makefile.build obj=lib/efi_driver
		make -f ./scripts/Makefile.build obj=lib/efi_loader
		make -f ./scripts/Makefile.build obj=lib/libfdt
		make -f ./scripts/Makefile.build obj=lib/zlib
		make -f ./scripts/Makefile.build obj=net
		make -f ./scripts/Makefile.build obj=examples
		make -f ./scripts/Makefile.build obj=dts dtbs
		make -f ./scripts/Makefile.build obj=arch/arm/dts dtbs
		make -f ./scripts/Makefile.build obj=arch/arm/mach-imx u-boot-dtb.imx
 
从make执行的顺序发现，依次编译了下面目录：

		scripts
		tools
		arch
			arm/cpu
			arm/cpu/armv7
			arm/lib
			arm/mach-imx
			arm/mach-imx/mx6
		board
			freescale/common
			freescale/mx6ullevk
		cmd
		common
		disk
		drivers
		env
		fs
		lib
		net
		examples
		dts 
		arch
			arm/dts 
			arm/mach-imx

下面逐一分析：  
### scripts
		目录下包含basic、dtc、kconfig子目录，分别编译出fixdep、dtc、conf执行程序，其中fixdep&conf在make mx6ull_14x14_evk_defconfig时已经编译；  

		下面是三条命令的使用基本方法：  
		fixdep <depfile> <target> <cmdline>  
		dtc [options] <input file>  
		conf [-s] [option] <kconfig-file>  

### tools

目录编译出下面可执行程序：

|命令|作用|
| ----------- | ----------- |
| dumpimage      | 解析itb，抽取内部文件       |
| fdtgrep   | U-Boot 设备树在构建过程中被 fdtgrep 工具过滤生成 SPL 中使用的更小的设备树的过程 (spl/u-boot-spl.dtb)和：- 强制节点（/alias、/chosen、/config）- 具有一个预重定位属性的节点：'u-boot,dm-pre-reloc' 或 'u-boot,dm-spl' fdtgrep 也用于删除：- CONFIG_OF_SPL_REMOVE_PROPS 中定义的属性        |
|fit_check_sign|检查FIT IMG的签名|
|fit_info|打印FIT文件中节点的偏移位置和长度信息|
|gen_eth_addr|生成MAC地址|
|gen_ethaddr_crc|获取MAC地址CRC校验|
|img2srec|用于将 Linux 启动映像 (zimage.initrd) 转换为用于闪存编程的 S-Record 格式|
|mkimage|用于创建 U-Boot 引导加载程序的映像；这些镜像可以包含 linux 内核、设备树 blob、根文件系统映像、固件映像等，可以是单独的，也可以是组合的|
|proftool|解析打印 U-Boot 信息|
|spl_size_limit|在构建期间返回可用于 SPL 图像的大小|


### arch


### board

### cmd

### common

### disk

### drivers

### env

### fs

### libf

### net

### examples

### dts

###arch
