# u-boot启动流程分析
从上电开机执行u-boot,到u-boot加载操作系统的过程。
## 第一阶段
### 功能  
  .硬件设备初始化  
  .加载u-boot第二阶段代码到RAM空间  
  .设置好栈  
  .跳转到第二阶段代码入口  
### 启动流程
1.设置异常向量   
2.CPU进入SVC模式  
3.设置控制寄存器地址  
4.关闭看门狗  
5.屏蔽中断  
6.设置MPLLCON/UPLLCON/CLKDIVN  
7.关闭MMU和cache  
8.初始化存储控制器  
9.复制u-boot第二阶段代码到RAM  
10.设置栈  
11.清除BSS段  
12.跳转第二阶段入口
## 第二阶段  
### 功能
  .初始化本阶段使用的硬件设备  
  .检测系统内存映射  
  .将内核从Flash读取到RAM中  
  .为内核设置启动参数  
  .调用内核
### 运行流程
1.板级相关初始化（board_init）  
2.时钟初始化（time_init）  
3.环境变量初始化（env_init）  
4.串口、控制台初始化（init_bandrare、serial_init、console_init_f）  
5.打印u-boot版本、编译时间等信息（display_banner)  
6.显示可用内存、显示内存大小（dram_init、display_dram_config）  
7.Nor flash初始化(flash_init)  
8.Nand Flash初始化(nand_init)  
9.调用main_loop(main_loop)
### main_loop流程
1.设置启动次数有关参数  
2.启用Modem功能  
3.设置版本号、初始化命令自动完成等功能  
4.启动延时和启动菜单  
5.执行命令循环