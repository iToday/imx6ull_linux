# 源码结构
目录结构如下：  
├── api  
├── arch  
├── board  
├── build.sh  
├── cmd  
├── common  
├── compilation_tool  
├── config.mk  
├── configs  
├── disk  
├── doc  
├── drivers  
├── dts  
├── env  
├── examples  
├── fs  
├── include  
├── Kbuild  
├── Kconfig  
├── lib  
├── Licenses  
├── MAINTAINERS  
├── Makefile  
├── net  
├── post  
├── README  
├── scripts  
├── set_env.sh  
├── test  
├── tools   

| 目录 | 说明 |
|  :---  |  :---  |
| api | 此目录下存放u-boot向外提供的接口函数 |
| arch | 与体系结构相关的代码，核心文件夹;包含arc/arm/m68k/microblaze/mips/nds32/power pc/risc-v 等 |
|board |此文件夹是根据不同的具体开发板而定制的代码,主要包含SDRAM、FLASH驱动；|
|common |独立于处理器体系结构的通用代码，如内存大小探测与故障检测；|
|disk |磁盘分区相关代码|
|doc |常见功能和问题的说明文档|
|drivers |常用的设备驱动程序，每个类型的设备驱动占用一个子目录|
|examples |示例程序|
|fs |文件系统，支持嵌入式开发常见的fs(cramfs,ext2,ext3,jffs2,etc)|
|include |全局需要的头文件定义在这儿,尤其configs子目录下与目标板相关的配置头文件是移植过程中经常要修改的文件；|
|lib |通用库文件|
|net |网络相关的代码，小型的协议栈,如bootp,nfs,tftp；|
|post |Power On Self Test，上电自检|
|Tools |辅助程序，用于编译和检查uboot目标文件,创建U-Boot S-RECORD和BIN镜像文件的工具|

其中处理器相关的代码集中在arch、board目录。
# 通用移植功能 #

为了使U-Boot支持新的开发板,一种简便的做法是在U-Boot已经支持的开发板中选择一种和目标板接近的,并在其基础上进行修改。代码修改的步骤如下：  

1.创建config文件
  在configs目录下创建自己的xxx_config文件，一般基于参考板config文件改写； 
 
2.创建板级目录   
  在board目录下创建自己的目录,并添加相应文件;注意目录名称与config文件的对应关系；

3.include 文件创建/修改  
  在include/configs目录下添加smdk2410.h,它定义了全局的宏定义等; 

4.板级设备树文件创建/修改  
 
5.Kconfig 文件配置  
 
最后运行make xxx_config,如果没有错误,就可以开始进行与硬件相关的代码移植工作。由于这部分代码与硬件紧密相关,所以要熟悉开发板的硬件配置,可参考各芯片的用户手册。  




